{"version":3,"sources":["../../src/middlewares/validation.middleware.ts"],"sourcesContent":["import { plainToInstance } from 'class-transformer';\nimport { validate, ValidationError } from 'class-validator';\nimport { RequestHandler } from 'express';\nimport { HttpException } from '@exceptions/HttpException';\n\nconst validationMiddleware = (\n  type: any,\n  value: string | 'body' | 'query' | 'params' = 'body',\n  skipMissingProperties = false,\n  whitelist = true,\n  forbidNonWhitelisted = true,\n): RequestHandler => {\n  return (req, res, next) => {\n    validate(plainToInstance(type, req[value]), { skipMissingProperties, whitelist, forbidNonWhitelisted }).then((errors: ValidationError[]) => {\n      if (errors.length > 0) {\n        const message = errors.map((error: ValidationError) => error.constraints ? Object.values(error.constraints) : error.children.map((error: ValidationError) => Object.values(error.constraints))).join(', ');\n        next(new HttpException(400, message));\n      } else {\n        next();\n      }\n    });\n  };\n};\n\nexport default validationMiddleware;\n"],"names":["validationMiddleware","type","value","skipMissingProperties","whitelist","forbidNonWhitelisted","req","res","next","validate","plainToInstance","then","errors","length","message","map","error","constraints","Object","values","children","join","HttpException"],"mappings":"AAAA;;;;+BAwBA,SAAoC;;aAApC,QAAoC;;kCAxBJ,mBAAmB;gCACT,iBAAiB;+BAE7B,6BAA2B;AAEzD,MAAMA,oBAAoB,GAAG,CAC3BC,IAAS,EACTC,KAA2C,GAAG,MAAM,EACpDC,qBAAqB,GAAG,KAAK,EAC7BC,SAAS,GAAG,IAAI,EAChBC,oBAAoB,GAAG,IAAI,GACR;IACnB,OAAO,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,GAAK;QACzBC,IAAAA,eAAQ,SAAA,EAACC,IAAAA,iBAAe,gBAAA,EAACT,IAAI,EAAEK,GAAG,CAACJ,KAAK,CAAC,CAAC,EAAE;YAAEC,qBAAqB;YAAEC,SAAS;YAAEC,oBAAoB;SAAE,CAAC,CAACM,IAAI,CAAC,CAACC,MAAyB,GAAK;YAC1I,IAAIA,MAAM,CAACC,MAAM,GAAG,CAAC,EAAE;gBACrB,MAAMC,OAAO,GAAGF,MAAM,CAACG,GAAG,CAAC,CAACC,KAAsB,GAAKA,KAAK,CAACC,WAAW,GAAGC,MAAM,CAACC,MAAM,CAACH,KAAK,CAACC,WAAW,CAAC,GAAGD,KAAK,CAACI,QAAQ,CAACL,GAAG,CAAC,CAACC,KAAsB,GAAKE,MAAM,CAACC,MAAM,CAACH,KAAK,CAACC,WAAW,CAAC,CAAC,CAAC,CAACI,IAAI,CAAC,IAAI,CAAC,AAAC;gBAC3Mb,IAAI,CAAC,IAAIc,cAAa,cAAA,CAAC,GAAG,EAAER,OAAO,CAAC,CAAC,CAAC;YACxC,OAAO;gBACLN,IAAI,EAAE,CAAC;YACT,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC,CAAC;AACJ,CAAC,AAAC;MAEF,QAAoC,GAArBR,oBAAoB"}